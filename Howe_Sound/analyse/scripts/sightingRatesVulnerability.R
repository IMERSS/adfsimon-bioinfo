# Sighting Rate Analysis

# Load libraries

library(dplyr)
library(ggplot2)
library(stringr)
library(tidyr)

# Read summary and occurrence data

summary <- read.csv("/Users/andrewsimon/GitHub/adfsimon-bioinfo/Howe_Sound/review/Plantae_et_Chromista/vascular_plants/outputs/vascular_plant_summary_resynthesized_2024-11-14.csv", fileEncoding = "UTF-8")

# Filter on historical records

historical <- summary %>% filter(reportingStatus == 'reported')

# Filter on provenance

native.historical <- historical %>% filter(establishmentMeans == 'native')

# Filter out Poales

preliminary.list <- native.historical %>% filter(order != 'Poales') 

# Earliest date

preliminary.list$earliestYear <- substr(preliminary.list$firstReported, 1, 4)

# TO DO: script 'last seen' index to ensure only historical voucher specimens are collected 

preliminary.list$YearsSinceLastSeen <- 2025 - as.numeric(preliminary.list$earliestYear)

# Write List for Initial Assessment

write.csv(preliminary.list, "/Users/andrewsimon/GitHub/adfsimon-bioinfo/Howe_Sound/analyse/outputs/preliminary_vulnerability_list.csv", row.names = FALSE)

# Read list for second pass assessment:

assessment.list <- read.csv("/Users/andrewsimon/GitHub/adfsimon-bioinfo/Howe_Sound/analyse/outputs/preliminary_vulnerability_list_reviewed_2025.csv")

# Filter out unlikely targets

assessment.list <- assessment.list %>% filter(initialAssessment == 'yes')

assessment.list$lastCollected <- substr(assessment.list$lastCollected, 1, 4)

assessment.list$YearsSinceLastSeen <- 2025 - as.numeric(assessment.list$lastCollected)

# Tabulate targets (preliminary ranking):

write.csv(assessment.list, "/Users/andrewsimon/GitHub/adfsimon-bioinfo/Howe_Sound/analyse/outputs/preliminary_assessment_list.csv", row.names = FALSE)

